define(["jquery","version!fly/managers/debug","version!fly/managers/components","managers/page-vars","managers/tealium","managers/waypoints","version!fly/components/base","version!libs/waypoints/jquery.waypoints"],function(t,e,i,n,o,a){e=e.init("lazyloadElement"),a.init(),t.widget("cnet.lazyloadElement",t.fly.base,{options:{attribute:"src",autoload:!0,src:null,threshold:1e3,tracking:null,loadOnCreate:!1},loaded:!1,waypoint:null,_create:function(){this._setup(),this._setupEvents()},_setupEvents:function(){var t=this;this.options.loadOnCreate?(e.log("Loading on creation"),t.load()):this.options.autoload&&(this.waypoint=new Waypoint({element:this.$element,handler:function(e){t.load(),this.destroy()},offset:this.options.threshold}))},load:function(e){if(!this.loaded){var i=this.options.src;!1===e&&(i=i.replace("autoplay=1","autoplay=0")),null===this.options.attribute?t.ajax({url:i,dataType:"json",context:{context:this}}).done(this._onSuccess).fail(this._onError):this.$element.attr(this.options.attribute,i),this.loaded=!0}},_onSuccess:function(e){"use strict";var n=this.context.$element,o=t(t.parseHTML(t.trim(e.component.html)));n.append(o),i.process(n),this.context.options.tracking&&this.context._track()},_onError:function(){},_track:function(){var t=n.tracking.data;o.trackCustomEvent("trackPageEvent",{articleId:t.articleId,articleTitle:t.articleTitle,articleType:t.articleType,clickGenericText:this.options.tracking,collectionId:t.collectionId,pageTitle:t.photoGalleryTitle,pageType:t.pageType,pageViewGuid:t.pageViewGuid,siteEdition:t.siteEdition,siteHier:t.siteHier,siteSection:t.siteSection,topicId:t.topicId,_dwAnonId:t._dwAnonId,brand:t.brand},"trackClick")}})});